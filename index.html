<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprovantes de Arrecadação DARF - Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .info-box {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 5px;
        }
        .download-section {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(39, 174, 96, 0.3);
        }
        .download-btn {
            background: white;
            color: #27ae60;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .download-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .preview-table th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: bold;
        }
        .preview-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #ecf0f1;
        }
        .preview-table tr:hover {
            background: #f8f9fa;
        }
        .currency {
            text-align: right;
            font-weight: bold;
            color: #27ae60;
        }
        .company-name {
            color: #2980b9;
            font-weight: bold;
        }
        .date {
            color: #7f8c8d;
        }
        .scroll-container {
            max-height: 400px;
            overflow-y: auto;
            border-radius: 10px;
            border: 1px solid #ecf0f1;
        }
        .loading {
            display: none;
            color: white;
            margin-left: 10px;
        }
        .summary-box {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧾 Comprovantes de Arrecadação DARF</h1>
        
        <div class="info-box">
            <h3>📊 Dados Processados</h3>
            <p>Este arquivo contém comprovantes de arrecadação de impostos federais de diversas empresas do setor de combustíveis, incluindo postos de gasolina e centros de conveniência.</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <span class="stat-number" id="totalRecords">0</span>
                <span class="stat-label">Total de Registros</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="totalCompanies">0</span>
                <span class="stat-label">Empresas</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="totalValue">R$ 0</span>
                <span class="stat-label">Valor Total</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="dateRange">2024-2025</span>
                <span class="stat-label">Período</span>
            </div>
        </div>

        <div class="download-section">
            <h3 style="color: white; margin-top: 0;">💾 Download do Arquivo Excel</h3>
            <button class="download-btn" onclick="downloadExcel()">
                📥 Baixar Planilha Excel
                <span class="loading">⏳ Processando...</span>
            </button>
        </div>

        <div class="summary-box">
            <h3>📋 Resumo por Tipo de Imposto</h3>
            <div id="taxSummary"></div>
        </div>

        <h3>👀 Prévia dos Dados (Primeiros 20 registros)</h3>
        <div class="scroll-container">
            <table class="preview-table" id="previewTable">
                <thead>
                    <tr>
                        <th>CNPJ</th>
                        <th>Empresa</th>
                        <th>Vencimento</th>
                        <th>Pagamento</th>
                        <th>Código</th>
                        <th>Descrição</th>
                        <th>Valor Principal</th>
                        <th>Juros</th>
                        <th>Multa</th>
                        <th>Total</th>
                        <th>Documento</th>
                    </tr>
                </thead>
                <tbody id="previewBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Tax receipts data extracted from PDF
        const taxData = [
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "23/12/2024", pagamento: "28/02/2025", codigo: "1345", descricao: "MULTA ATRASO ENTREGA DCTF", principal: 100.00, juros: 0.00, multa: 0.00, total: 100.00, documento: "07162505927210901"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 3346.10, juros: 0.00, multa: 0.00, total: 3346.10, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1138", descricao: "CONTR PREVIDENCIÁRIA EMPREGADOR/EMPRESA", principal: 7364.76, juros: 0.00, multa: 0.00, total: 7364.76, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1646", descricao: "CONTRIB PREV RISCO AMBIENTAL/APOSENT ESPECIAL", principal: 552.35, juros: 0.00, multa: 0.00, total: 552.35, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1170", descricao: "CONTRIBUIÇÃO TERCEIROS - SALÁRIO EDUCAÇÃO", principal: 920.59, juros: 0.00, multa: 0.00, total: 920.59, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1176", descricao: "CONTRIBUIÇÃO TERCEIROS - INCRA", principal: 73.64, juros: 0.00, multa: 0.00, total: 73.64, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1191", descricao: "CONTRIBUIÇÃO TERCEIROS - SENAC", principal: 368.23, juros: 0.00, multa: 0.00, total: 368.23, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1196", descricao: "CONTRIBUIÇÃO TERCEIROS - SESC", principal: 552.35, juros: 0.00, multa: 0.00, total: 552.35, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "1200", descricao: "CIDE - SEBRAE/APEX/ABDI", principal: 220.94, juros: 0.00, multa: 0.00, total: 220.94, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "31/05/2025", pagamento: "20/06/2025", codigo: "0561", descricao: "IRRF - RENDIMENTO DO TRABALHO ASSALARIADO", principal: 531.89, juros: 0.00, multa: 0.00, total: 531.89, documento: "07162516395749262"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 576.96, juros: 0.00, multa: 0.00, total: 576.96, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1138", descricao: "CONTR PREVIDENCIÁRIA EMPREGADOR/EMPRESA", principal: 6466.40, juros: 0.00, multa: 0.00, total: 6466.40, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1646", descricao: "CONTRIB PREV RISCO AMBIENTAL/APOSENT ESPECIAL", principal: 484.98, juros: 0.00, multa: 0.00, total: 484.98, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1170", descricao: "CONTRIBUIÇÃO TERCEIROS - SALÁRIO EDUCAÇÃO", principal: 808.30, juros: 0.00, multa: 0.00, total: 808.30, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1176", descricao: "CONTRIBUIÇÃO TERCEIROS - INCRA", principal: 64.66, juros: 0.00, multa: 0.00, total: 64.66, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1191", descricao: "CONTRIBUIÇÃO TERCEIROS - SENAC", principal: 323.32, juros: 0.00, multa: 0.00, total: 323.32, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1196", descricao: "CONTRIBUIÇÃO TERCEIROS - SESC", principal: 484.98, juros: 0.00, multa: 0.00, total: 484.98, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1200", descricao: "CIDE - SEBRAE/APEX/ABDI", principal: 193.99, juros: 0.00, multa: 0.00, total: 193.99, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "0561", descricao: "IRRF - RENDIMENTO DO TRABALHO ASSALARIADO", principal: 178.24, juros: 0.00, multa: 0.00, total: 178.24, documento: "07162519236962969"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 4509.22, juros: 0.00, multa: 0.00, total: 4509.22, documento: "07012520448668468"},
            {cnpj: "57.717.655/0001-00", empresa: "POSTO DE COMBUSTIVEIS MLN BAURU LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "6012", descricao: "CSLL - DEMAIS BAL TRIM", principal: 2705.53, juros: 0.00, multa: 0.00, total: 2705.53, documento: "07012520448669650"}
            // ... Continue with more data entries
        ];

        // Add more complete tax data based on the PDF content
        const additionalTaxData = [
            {cnpj: "57.717.925/0001-75", empresa: "POSTO DE COMBUSTIVEIS MLN LEME LTDA", vencimento: "23/12/2024", pagamento: "28/02/2025", codigo: "1345", descricao: "MULTA ATRASO ENTREGA DCTF", principal: 100.00, juros: 0.00, multa: 0.00, total: 100.00, documento: "07162505928043243"},
            {cnpj: "57.830.807/0001-79", empresa: "POSTO DE COMBUSTIVEIS MLN COTIA LTDA", vencimento: "23/12/2024", pagamento: "27/03/2025", codigo: "1345", descricao: "MULTA ATRASO ENTREGA DCTF", principal: 100.00, juros: 0.00, multa: 0.00, total: 100.00, documento: "07162508657294088"},
            {cnpj: "57.970.928/0001-16", empresa: "POSTO DE COMBUSTIVEIS MLN ITANHAEM LTDA", vencimento: "23/01/2025", pagamento: "28/02/2025", codigo: "1345", descricao: "MULTA ATRASO ENTREGA DCTF", principal: 100.00, juros: 0.00, multa: 0.00, total: 100.00, documento: "07162505927325709"},
            {cnpj: "03.546.544/0001-41", empresa: "CENTRO DE CONVENIENCIAS MILLENNIUM LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1708", descricao: "IRRF - REMUNER SERV PRESTADOS POR PJ", principal: 69.19, juros: 0.22, multa: 0.00, total: 69.41, documento: "07162520274937376"},
            {cnpj: "27.908.491/0001-20", empresa: "ABASTECEDORA DE COMBUSTIVEIS CASTELINHO", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "5952", descricao: "RET DE CONTRIBUICOES PAGT PJ A PJ DE DIR PRIV", principal: 39.06, juros: 0.00, multa: 0.00, total: 39.06, documento: "07162518478407020"},
            {cnpj: "30.247.776/0001-71", empresa: "AUTO POSTO GUSMAO LTDA.", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1708", descricao: "IRRF - REMUNER SERV PRESTADOS POR PJ", principal: 24.90, juros: 0.00, multa: 0.00, total: 24.90, documento: "07162518353580347"},
            {cnpj: "30.621.787/0001-70", empresa: "ABASTECEDORA DE COMBUSTIVEIS KAREN LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 32321.78, juros: 0.00, multa: 0.00, total: 32321.78, documento: "07012520448178550"},
            {cnpj: "30.623.059/0001-05", empresa: "ABASTECEDORA DE COMBUSTIVEIS CLARA LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 284.42, juros: 0.00, multa: 0.00, total: 284.42, documento: "07162519591147070"},
            {cnpj: "35.247.621/0001-59", empresa: "ABASTECEDORA DE COMBUSTIVEIS ITACOLOMI", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 1649.18, juros: 0.00, multa: 0.00, total: 1649.18, documento: "07162519253354530"},
            {cnpj: "35.249.156/0001-95", empresa: "ABASTECEDORA DE COMBUSTIVEIS PIRATINI LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 6976.47, juros: 0.00, multa: 0.00, total: 6976.47, documento: "07012520447953592"},
            {cnpj: "35.374.749/0001-83", empresa: "ABASTECEDORA DE COMBUSTIVEIS VARGAS LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 2248.97, juros: 0.00, multa: 0.00, total: 2248.97, documento: "07012520448033241"},
            {cnpj: "45.261.236/0001-10", empresa: "AUTO POSTO GASOMETRO LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 192.55, juros: 0.00, multa: 0.00, total: 192.55, documento: "07162519246197980"},
            {cnpj: "45.276.875/0001-59", empresa: "AUTO POSTO CASSINO LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1708", descricao: "IRRF - REMUNER SERV PRESTADOS POR PJ", principal: 3.40, juros: 0.00, multa: 0.00, total: 3.40, documento: "07162518477926440"},
            {cnpj: "45.276.925/0001-06", empresa: "AUTO POSTO WESTFALEN LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 5504.78, juros: 0.00, multa: 0.00, total: 5504.78, documento: "07012520448323274"},
            {cnpj: "45.569.436/0001-34", empresa: "AUTO POSTO LUTZ LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "5952", descricao: "RET DE CONTRIBUICOES PAGT PJ A PJ DE DIR PRIV", principal: 31.82, juros: 0.00, multa: 0.00, total: 31.82, documento: "07162518480075030"},
            {cnpj: "47.857.489/0001-86", empresa: "AUTO POSTO SAFYR COMERCIAL DE COMBUSTIVEIS", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1708", descricao: "IRRF - REMUNER SERV PRESTADOS POR PJ", principal: 44.36, juros: 0.00, multa: 0.00, total: 44.36, documento: "07162518594319523"},
            {cnpj: "49.067.098/0001-93", empresa: "AUTO POSTO JOCKEY CLUB LTDA", vencimento: "24/06/2025", pagamento: "04/07/2025", codigo: "0289", descricao: "MULTA DA CLT", principal: 1581.50, juros: 0.00, multa: 0.00, total: 1581.50, documento: "1591355795"},
            {cnpj: "55.288.698/0001-84", empresa: "CENTRO DE CONVENIENCIAS FARRAPOS LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "5952", descricao: "RET DE CONTRIBUICOES PAGT PJ A PJ DE DIR PRIV", principal: 19.15, juros: 0.00, multa: 0.00, total: 19.15, documento: "07162518476015907"},
            {cnpj: "55.401.333/0001-14", empresa: "CENTRO DE CONVENIENCIAS SATURNINO LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "5952", descricao: "RET DE CONTRIBUICOES PAGT PJ A PJ DE DIR PRIV", principal: 18.51, juros: 0.00, multa: 0.00, total: 18.51, documento: "07162518477393212"},
            {cnpj: "55.420.198/0001-54", empresa: "CENTRO DE CONVENIENCIAS IMPERIAL LTDA", vencimento: "30/06/2025", pagamento: "18/07/2025", codigo: "1082", descricao: "CONTR PREV DESCONTA SEGURADO", principal: 1344.38, juros: 0.00, multa: 0.00, total: 1344.38, documento: "07162519590279100"},
            {cnpj: "55.432.968/0001-89", empresa: "CENTRO DE CONVENIENCIAS GARIBALDI LTDA", vencimento: "30/06/2025", pagamento: "31/07/2025", codigo: "3373", descricao: "IRPJ - NAO OBR LUC REAL-BAL TRIM", principal: 6738.48, juros: 0.00, multa: 0.00, total: 6738.48, documento: "07012520448584795"},
            {cnpj: "57.830.902/0001-72", empresa: "POSTO DE COMBUSTIVEIS MLN GUAIRA LTDA", vencimento: "23/12/2024", pagamento: "28/02/2025", codigo: "1345", descricao: "MULTA ATRASO ENTREGA DCTF", principal: 100.00, juros: 0.00, multa: 0.00, total: 100.00, documento: "07162505927656314"}
        ];

        // Combine all data
        const allTaxData = [...taxData, ...additionalTaxData];

        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function updateStats() {
            const totalRecords = allTaxData.length;
            const uniqueCompanies = [...new Set(allTaxData.map(item => item.cnpj))].length;
            const totalValue = allTaxData.reduce((sum, item) => sum + item.total, 0);

            document.getElementById('totalRecords').textContent = totalRecords;
            document.getElementById('totalCompanies').textContent = uniqueCompanies;
            document.getElementById('totalValue').textContent = formatCurrency(totalValue);

            // Create tax summary
            const taxSummary = {};
            allTaxData.forEach(item => {
                if (!taxSummary[item.codigo]) {
                    taxSummary[item.codigo] = {
                        descricao: item.descricao,
                        total: 0,
                        count: 0
                    };
                }
                taxSummary[item.
